name: setup-go-ci
description: Checkout + Setup Go + optional vet/test
inputs:
  go-version:
    required: true
  run-tests:
    default: "true"
  run-vet:
    default: "true"
runs:
  using: composite
  steps:
    - uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6
    - uses: actions/setup-go@4dc6199c7b1a012772edbd06daecab0f50c9053c # v6
      with:
        go-version: ${{ inputs.go-version }}
        check-latest: true
    - if: ${{ inputs.run-vet == 'true' }}
      shell: bash
      run: |
        go mod tidy
        go mod download
        go mod verify
        go vet ./...
    - if: ${{ inputs.run-tests == 'true' }}
      shell: bash
      run: go test -race -cover ./...
